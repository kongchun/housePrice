!function t(n,e,o){function i(a,l){if(!e[a]){if(!n[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[a]={exports:{}};n[a][0].call(c.exports,function(t){var e=n[a][1][t];return i(e?e:t)},c,c.exports,t,n,e,o)}return e[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(t,n,e){"use strict";var o=window.BMapLib=o||{};!function(){function t(t,n,e){return null!=n&&(t=Math.max(t,n)),null!=e&&(t=Math.min(t,e)),t}function n(t,n,e){for(;t>e;)t-=e-n;for(;t<n;)t+=e-n;return t}var e=6370996.81,i=o.GeoUtils=function(){};i.isPointInRect=function(t,n){if(!(t instanceof BMap.Point&&n instanceof BMap.Bounds))return!1;var e=n.getSouthWest(),o=n.getNorthEast();return t.lng>=e.lng&&t.lng<=o.lng&&t.lat>=e.lat&&t.lat<=o.lat},i.isPointInCircle=function(t,n){if(!(t instanceof BMap.Point&&n instanceof BMap.Circle))return!1;var e=n.getCenter(),o=n.getRadius(),r=i.getDistance(t,e);return r<=o},i.isPointOnPolyline=function(t,n){if(!(t instanceof BMap.Point&&n instanceof BMap.Polyline))return!1;var e=n.getBounds();if(!this.isPointInRect(t,e))return!1;for(var o=n.getPath(),i=0;i<o.length-1;i++){var r=o[i],a=o[i+1];if(t.lng>=Math.min(r.lng,a.lng)&&t.lng<=Math.max(r.lng,a.lng)&&t.lat>=Math.min(r.lat,a.lat)&&t.lat<=Math.max(r.lat,a.lat)){var l=(r.lng-t.lng)*(a.lat-t.lat)-(a.lng-t.lng)*(r.lat-t.lat);if(l<2e-10&&l>-2e-10)return!0}}return!1},i.isPointInPolygon=function(t,n){if(!(t instanceof BMap.Point&&n instanceof BMap.Polygon))return!1;var e=n.getBounds();if(!this.isPointInRect(t,e))return!1;var o,i,r=n.getPath(),a=r.length,l=!0,s=0,u=2e-10,c=t;o=r[0];for(var p=1;p<=a;++p){if(c.equals(o))return l;if(i=r[p%a],c.lat<Math.min(o.lat,i.lat)||c.lat>Math.max(o.lat,i.lat))o=i;else{if(c.lat>Math.min(o.lat,i.lat)&&c.lat<Math.max(o.lat,i.lat)){if(c.lng<=Math.max(o.lng,i.lng)){if(o.lat==i.lat&&c.lng>=Math.min(o.lng,i.lng))return l;if(o.lng==i.lng){if(o.lng==c.lng)return l;++s}else{var g=(c.lat-o.lat)*(i.lng-o.lng)/(i.lat-o.lat)+o.lng;if(Math.abs(c.lng-g)<u)return l;c.lng<g&&++s}}}else if(c.lat==i.lat&&c.lng<=i.lng){var h=r[(p+1)%a];c.lat>=Math.min(o.lat,h.lat)&&c.lat<=Math.max(o.lat,h.lat)?++s:s+=2}o=i}}return s%2!=0},i.degreeToRad=function(t){return Math.PI*t/180},i.radToDegree=function(t){return 180*t/Math.PI},i.getDistance=function(o,r){if(!(o instanceof BMap.Point&&r instanceof BMap.Point))return 0;o.lng=n(o.lng,-180,180),o.lat=t(o.lat,-74,74),r.lng=n(r.lng,-180,180),r.lat=t(r.lat,-74,74);var a,l,s,u;return a=i.degreeToRad(o.lng),s=i.degreeToRad(o.lat),l=i.degreeToRad(r.lng),u=i.degreeToRad(r.lat),e*Math.acos(Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos(l-a))},i.getPolylineDistance=function(t){if(t instanceof BMap.Polyline||t instanceof Array){var n;if(n=t instanceof BMap.Polyline?t.getPath():t,n.length<2)return 0;for(var e=0,o=0;o<n.length-1;o++){var r=n[o],a=n[o+1],l=i.getDistance(r,a);e+=l}return e}return 0},i.getPolygonArea=function(t){if(!(t instanceof BMap.Polygon||t instanceof Array))return 0;var n;if(n=t instanceof BMap.Polygon?t.getPath():t,n.length<3)return 0;for(var o=0,i=0,r=0,a=0,l=0,s=0,u=0,c=0,p=0,g=0,h=0,f=0,d=0,v=0,_=0,M=0,m=0,y=0,w=0,P=0,x=0,C=0,b=0,B=0,I=0,S=0,D=0,z=0,E=0,O=0,k=0,F=0,T=0,L=0,A=e,R=n.length,U=0;U<R;U++)0==U?(i=n[R-1].lng*Math.PI/180,r=n[R-1].lat*Math.PI/180,a=n[0].lng*Math.PI/180,l=n[0].lat*Math.PI/180,s=n[1].lng*Math.PI/180,u=n[1].lat*Math.PI/180):U==R-1?(i=n[R-2].lng*Math.PI/180,r=n[R-2].lat*Math.PI/180,a=n[R-1].lng*Math.PI/180,l=n[R-1].lat*Math.PI/180,s=n[0].lng*Math.PI/180,u=n[0].lat*Math.PI/180):(i=n[U-1].lng*Math.PI/180,r=n[U-1].lat*Math.PI/180,a=n[U].lng*Math.PI/180,l=n[U].lat*Math.PI/180,s=n[U+1].lng*Math.PI/180,u=n[U+1].lat*Math.PI/180),c=Math.cos(l)*Math.cos(a),p=Math.cos(l)*Math.sin(a),g=Math.sin(l),h=Math.cos(r)*Math.cos(i),f=Math.cos(r)*Math.sin(i),d=Math.sin(r),v=Math.cos(u)*Math.cos(s),_=Math.cos(u)*Math.sin(s),M=Math.sin(u),m=(c*c+p*p+g*g)/(c*h+p*f+g*d),y=(c*c+p*p+g*g)/(c*v+p*_+g*M),w=m*h-c,P=m*f-p,x=m*d-g,C=y*v-c,b=y*_-p,B=y*M-g,E=(C*w+b*P+B*x)/(Math.sqrt(C*C+b*b+B*B)*Math.sqrt(w*w+P*P+x*x)),E=Math.acos(E),I=b*x-B*P,S=0-(C*x-B*w),D=C*P-b*w,z=0!=c?I/c:0!=p?S/p:D/g,z>0?(O+=E,T++):(k+=E,F++);var j,N;return j=O+(2*Math.PI*F-k),N=2*Math.PI*T-O+k,L=O>k?j-(R-2)*Math.PI<1?j:N:N-(R-2)*Math.PI<1?N:j,o=(L-(R-2)*Math.PI)*A*A}}()},{}],2:[function(t,n,e){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=window.BMapLib=i||{};!function(){function t(t,n,e){0!=n.indexOf("on")&&(n="on"+n);var o=new r.lang.Event(n);if(e)for(var i in e)o[i]=e[i];t.dispatchEvent(o)}function n(t){if(t){var e=t.attributes,o="";if(e)for(var i=0,r=e.length;i<r;i++)o=e[i].name,"function"==typeof t[o]&&(t[o]=null);var a=t.childnodes;if(a)for(var i=0,r=a.length;i<r;i++)n(t.childnodes[i])}}function e(t){var t=window.event||t;return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,r.preventDefault(t)}var r=r||{guid:"$BAIDU$"};!function(){window[r.guid]={},r.extend=function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},r.lang=r.lang||{},r.lang.guid=function(){return"TANGRAM__"+(window[r.guid]._counter++).toString(36)},window[r.guid]._counter=window[r.guid]._counter||1,window[r.guid]._instances=window[r.guid]._instances||{},r.lang.Class=function(t){this.guid=t||r.lang.guid(),window[r.guid]._instances[this.guid]=this},window[r.guid]._instances=window[r.guid]._instances||{},r.lang.isString=function(t){return"[object String]"==Object.prototype.toString.call(t)},r.isString=r.lang.isString,r.lang.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},r.lang.Event=function(t,n){this.type=t,this.returnValue=!0,this.target=n||null,this.currentTarget=null},r.lang.Class.prototype.addEventListener=function(t,n,e){if(r.lang.isFunction(n)){!this.__listeners&&(this.__listeners={});var i,a=this.__listeners;if("string"==typeof e&&e){if(/[^\w\-]/.test(e))throw"nonstandard key:"+e;n.hashCode=e,i=e}0!=t.indexOf("on")&&(t="on"+t),"object"!=o(a[t])&&(a[t]={}),i=i||r.lang.guid(),n.hashCode=i,a[t][i]=n}},r.lang.Class.prototype.removeEventListener=function(t,n){if(r.lang.isFunction(n))n=n.hashCode;else if(!r.lang.isString(n))return;!this.__listeners&&(this.__listeners={}),0!=t.indexOf("on")&&(t="on"+t);var e=this.__listeners;e[t]&&e[t][n]&&delete e[t][n]},r.lang.Class.prototype.dispatchEvent=function(t,n){r.lang.isString(t)&&(t=new r.lang.Event(t)),!this.__listeners&&(this.__listeners={}),n=n||{};for(var e in n)t[e]=n[e];var e,i=this.__listeners,a=t.type;if(t.target=t.target||this,t.currentTarget=this,0!=a.indexOf("on")&&(a="on"+a),r.lang.isFunction(this[a])&&this[a].apply(this,arguments),"object"==o(i[a]))for(e in i[a])i[a][e].apply(this,arguments);return t.returnValue},r.dom=r.dom||{},r.dom._g=function(t){return r.lang.isString(t)?document.getElementById(t):t},r._g=r.dom._g,r.event=r.event||{},r.event._listeners=r.event._listeners||[],r.event.on=function(t,n,e){n=n.replace(/^on/i,""),t=r.dom._g(t);var o,i=function(n){e.call(t,n)},a=r.event._listeners,l=r.event._eventFilter,s=n;return n=n.toLowerCase(),l&&l[n]&&(o=l[n](t,n,i),s=o.type,i=o.listener),t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent&&t.attachEvent("on"+s,i),a[a.length]=[t,n,e,i,s],t},r.on=r.event.on,r.event.un=function(t,n,e){t=r.dom._g(t),n=n.replace(/^on/i,"").toLowerCase();for(var o,i,a,l=r.event._listeners,s=l.length,u=!e;s--;)o=l[s],o[1]!==n||o[0]!==t||!u&&o[2]!==e||(i=o[4],a=o[3],t.removeEventListener?t.removeEventListener(i,a,!1):t.detachEvent&&t.detachEvent("on"+i,a),l.splice(s,1));return t},r.un=r.event.un,r.preventDefault=r.event.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}}();var a=i.RichMarker=function(t,n,e){t&&n&&n instanceof BMap.Point&&(this._map=null,this._content=t,this._position=n,this._container=null,this._size=null,e=e||{},this._opts=r.extend(r.extend(this._opts||{},{enableDragging:!1,anchor:new BMap.Size(0,0)}),e))};a.prototype=new BMap.Overlay,a.prototype.initialize=function(t){var n=this,e=n._container=document.createElement("div");return n._map=t,r.extend(e.style,{position:"absolute",zIndex:BMap.Overlay.getZIndex(n._position.lat),background:"#FFF",cursor:"pointer"}),t.getPanes().labelPane.appendChild(e),n._appendContent(),n._setEventDispath(),n._getContainerSize(),e},a.prototype.draw=function(){var t=this._map,n=this._opts.anchor,e=t.pointToOverlayPixel(this._position);this._container.style.left=e.x+n.width+"px",this._container.style.top=e.y+n.height+"px"},a.prototype.enableDragging=function(){this._opts.enableDragging=!0},a.prototype.disableDragging=function(){this._opts.enableDragging=!1},a.prototype.isDraggable=function(){return this._opts.enableDragging},a.prototype.getPosition=function(){return this._position},a.prototype.setPosition=function(t){!t instanceof BMap.Point||(this._position=t,this.draw())},a.prototype.getAnchor=function(){return this._opts.anchor},a.prototype.setAnchor=function(t){!t instanceof BMap.Size||(this._opts.anchor=t,this.draw())},a.prototype._appendContent=function(){var t=this._content;if("string"==typeof t){var n=document.createElement("DIV");if(n.innerHTML=t,1==n.childNodes.length)t=n.removeChild(n.firstChild);else{for(var e=document.createDocumentFragment();n.firstChild;)e.appendChild(n.firstChild);t=e}}this._container.innerHTML="",this._container.appendChild(t)},a.prototype.getContent=function(){return this._content},a.prototype.setContent=function(t){t&&(this._content=t,this._appendContent())},a.prototype._getContainerSize=function(){if(this._container){var t=this._container.offsetHeight,n=this._container.offsetWidth;this._size=new BMap.Size(n,t)}},a.prototype.getWidth=function(){if(this._size)return this._size.width},a.prototype.setWidth=function(t){this._container&&(this._container.style.width=t+"px",this._getContainerSize())},a.prototype.getHeight=function(){if(this._size)return this._size.height},a.prototype.setHeight=function(t){this._container&&(this._container.style.height=t+"px",this._getContainerSize())},a.prototype._setEventDispath=function(){function n(t){var t=window.event||t,n=t.pageX||t.clientX||0,e=t.pageY||t.clientY||0,i=new BMap.Pixel(n,e),r=o._map.pixelToPoint(i);return{pixel:i,point:r}}var o=this,i=o._container,a=!1,l=null;r.on(i,"onclick",function(n){t(o,"onclick"),e(n)}),r.on(i,"ontouchend",function(n){t(o,"ontouchend"),t(o,"onclick"),e(n)}),r.on(i,"ondblclick",function(i){var r=n(i);t(o,"ondblclick",{point:r.point,pixel:r.pixel}),e(i)}),i.onmouseover=function(i){var r=n(i);t(o,"onmouseover",{point:r.point,pixel:r.pixel}),e(i)},i.onmouseout=function(i){var r=n(i);t(o,"onmouseout",{point:r.point,pixel:r.pixel}),e(i)};var s=function s(c){var p=n(c);return t(o,"onmouseup",{point:p.point,pixel:p.pixel}),o._container.releaseCapture?(r.un(i,"onmousemove",u),r.un(i,"onmouseup",s)):(r.un(window,"onmousemove",u),r.un(window,"onmouseup",s)),o._opts.enableDragging?(o._container.releaseCapture&&o._container.releaseCapture(),t(o,"ondragend",{point:p.point,pixel:p.pixel}),a=!1,l=null,o._setCursor("dragend"),o._container.style.MozUserSelect="",o._container.style.KhtmlUserSelect="",o._container.style.WebkitUserSelect="",o._container.unselectable="off",o._container.onselectstart=function(){},void e(c)):void e(c)},u=function(i){if(o._opts.enableDragging&&a){var r=n(i),s=o._map.pointToPixel(o._position),u=r.pixel.x-l.x+s.x,c=r.pixel.y-l.y+s.y;l=r.pixel,o._position=o._map.pixelToPoint(new BMap.Pixel(u,c)),o.draw(),o._setCursor("dragging"),t(o,"ondragging",{point:r.point,pixel:r.pixel}),e(i)}};r.on(i,"onmousedown",function(c){var p=n(c);return t(o,"onmousedown",{point:p.point,pixel:p.pixel}),o._container.setCapture?(r.on(i,"onmousemove",u),r.on(i,"onmouseup",s)):(r.on(window,"onmousemove",u),r.on(window,"onmouseup",s)),o._opts.enableDragging?(l=p.pixel,t(o,"ondragstart",{point:p.point,pixel:p.pixel}),a=!0,o._setCursor("dragstart"),o._container.setCapture&&o._container.setCapture(),o._container.style.MozUserSelect="none",o._container.style.KhtmlUserSelect="none",o._container.style.WebkitUserSelect="none",o._container.unselectable="on",o._container.onselectstart=function(){return!1},void e(c)):void e(c)})},a.prototype._setCursor=function(t){var n="",e={moz:{dragstart:"-moz-grab",dragging:"-moz-grabbing",dragend:"pointer"},other:{dragstart:"move",dragging:"move",dragend:"pointer"}};n=navigator.userAgent.indexOf("Gecko/")!==-1?e.moz[t]:e.other[t],this._container.style.cursor!=n&&(this._container.style.cursor=n)},a.prototype.remove=function(){t(this,"onremove"),this._container&&n(this._container),this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container)}}()},{}],3:[function(t,n,e){"use strict";function o(t){u=l.loadDistrict(suzhou_district),c=l.loadArea(suzhou_area),p=l.loadCommunity(suzhou_community)}function i(){$("#map").height($(window).height())}function r(){var t=a=new BMap.Map("map"),n=new BMap.NavigationControl;new BMap.ScaleControl({anchor:BMAP_ANCHOR_TOP_RIGHT});t.centerAndZoom("苏州市",12),t.addControl(n),t.enableScrollWheelZoom(),t.enableContinuousZoom()}var a,l=t("./marker.js"),s=0;$(function(){i(),r(),o(),$(window).on("resize",i);var t=a;l.showMarkers(t,u),t.addEventListener("zoomend",function(n){var e=t.getZoom();return e<13?void(1!=s&&(t.clearOverlays(),l.showMarkers(t,u),s=1,console.log("district"))):e<15?void(2!=s&&(t.clearOverlays(),l.showMarkers(t,c),s=2,console.log("area"))):void(3!=s&&(t.clearOverlays(),s=3,console.log("community")))}),t.addEventListener("tilesloaded",function(){3==s&&(console.log("communityMarkers"),l.showMarkersInBounds(t,p))})});var u,c,p},{"./marker.js":4}],4:[function(t,n,e){"use strict";function o(t){return new BMap.Point(t.lng,t.lat)}function i(t,n){var e=l(t,n),o=e.point,i=e.text,r=e.fillColor,a=c(map,o,i,r);return a}function r(t,n){var e=s(t,n),o=e.point,i=e.text,r=e.fillColor,a=c(map,o,i,r);return a}Object.defineProperty(e,"__esModule",{value:!0});var a=["#FF6600","#FF9933","#FFCC33","#99CC33","#789E27"],l=(e.loadDistrict=function(t){var n=t.map(function(t){return i(t,t.district)});return n},e.loadArea=function(t){var n=t.map(function(t){return i(t,t.area)});return n},e.loadCommunity=function(t){var n=t.map(function(t){return r(t,t.name)});return n},e.showMarkers=function(t,n){n.forEach(function(n){t.addOverlay(n)})},e.showMarkersInBounds=function(t,n){var e=t.getBounds();n.forEach(function(n){var o=BMapLib.GeoUtils.isPointInRect(n.point,e);o?t.addOverlay(n):t.removeOverlay(n)})},function(t,n){var e=u(t),o=e.point,i=e.compare,r=e.fillColor,a=n+" "+t.price+"元/m²<br/>浮动："+i;return{point:o,text:a,fillColor:r}}),s=function(t,n){var e=u(t),o=e.point,i=e.compare,r=e.fillColor,a=n+" <br/>"+t.price+"元/m² "+i;return{point:o,text:a,fillColor:r}},u=function(t){var n=o(t.point),e="",i=a[1];return"up"==t.upDown?e=t.compare+"% ↑":(e=t.compare+"% ↓",i=a[3]),{point:n,compare:e,fillColor:i}},c=function(t,n,e,o){var i={position:n,offset:new BMap.Size((-30),(-30))},r=new BMap.Label(e,i);return r.setStyle({backgroundColor:o,fontSize:"14px",fontFamily:"微软雅黑",padding:"6px",border:0,opacity:.9}),r}},{}]},{},[3,2,1]);